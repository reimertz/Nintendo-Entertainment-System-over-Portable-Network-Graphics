<DOCTYPE html>
<html>
	<head>
		<title>nesnes tests</title>
	</head>
	<body>
		<form id="testform" method="GET">
			<select id="testselect" name="game" onchange="debugform.submit()">
				<option value="">(select a game)</option>
				<optgroup label="Misc tests">
					<option value="./roms/nestress/NEStress">NEStress</option>
				</optgroup>
				<optgroup label="CPU tests">
					<option value="./roms/nestest">nestest (CPU tests)</option>
					<option value="./roms/instr_misc">instructions misc</option>
					<option value="./roms/cpu_interrupts/cpu_interrupts">interrupts</option>
				</optgroup>
				<optgroup label="CPU interrupts">
					<option value="./roms/interrupt/1-cli_latency">1. CLI latency</option>
					<option value="./roms/interrupt/2-nmi_and_brk">2. NMI &amp; BRK</option>
					<option value="./roms/interrupt/3-nmi_and_irq">3. NMI &amp; IRQ</option>
					<option value="./roms/interrupt/4-irq_and_dma">4. IRQ &amp; DMA</option>
					<option value="./roms/interrupt/5-branch_delays">5. Branch delays</option>
				</optgroup>
				<optgroup label="CPU instructions">
					<option value="./roms/instr/01-basics">01. basics</option>
					<option value="./roms/instr/02-implied">02. implied</option>
					<option value="./roms/instr/03-immediate">03. immediate</option>
				</optgroup>
				<optgroup label="PPU VBL & NMI">
					<option value="./roms/ppu/ppu_vbl_nmi">VBL & NMI, all</option>
					<option value="./roms/ppu/rom_singles/01-vbl_basics">VBL basics</option>
					<option value="./roms/ppu/rom_singles/02-vbl_set_time">VBL set time</option>
					<option value="./roms/ppu/rom_singles/03-vbl_clear_time">VBL clear time</option>
					<option value="./roms/ppu/rom_singles/04-nmi_control">NMI control</option>
					<option value="./roms/ppu/rom_singles/05-nmi_timing">NMI timing</option>
					<option value="./roms/ppu/rom_singles/06-suppression">Suppression</option>
				</optgroup>
				<optgroup label="APU tests">
					<option value="./roms/apu/rom_singles/1-len_ctr">Length counters</option>
					<option value="./roms/apu/rom_singles/2-len_table">Length table</option>
					<option value="./roms/apu/rom_singles/3-irq_flag">IRQ flag</option>
				</optgroup>
				<optgroup label="PPU basic tests">
					<option value="./roms/ppu2/sprite_ram">Sprite RAM</option>
					<option value="./roms/ppu2/palette_ram">Palette RAM</option>
					<option value="./roms/ppu2/vbl_clear_time">VBL clear time</option>
					<option value="./roms/ppu2/vram_access">VRAM access</option>
				</optgroup>
				<optgroup label="Sprite overflow tests">
					<option value="./roms/sprite_overflow/1.Basics">1. Basics</option>
					<option value="./roms/sprite_overflow/2.Details">2. Details</option>
					<option value="./roms/sprite_overflow/3.Timing">3. Timing</option>
				</optgroup>
				<optgroup label="Sprite hit tests">
					<option value="./roms/sprite_hit_tests/01.basics">Blarg, 01. Basics</option>
					<option value="./roms/sprite_hit_tests/02.alignment">Blarg, 02. Alignment</option>
					<option value="./roms/sprite_hit_tests/03.corners">Blarg, 03. Corners</option>
					<option value="./roms/sprite_hit_tests/04.flip">Blarg, 04. Flip</option>
					<option value="./roms/sprite_hit_tests/05.left_clip">Blarg, 05. Left clip</option>
					<option value="./roms/sprite_hit_tests/06.right_edge">Blarg, 06. Right edge</option>
					<option value="./roms/sprite_hit_tests/07.screen_bottom">Blarg, 07. Screen bottom</option>
					<option value="./roms/sprite_hit_tests/08.double_height">Blarg, 08. Double height</option>
					<option value="./roms/sprite_hit_tests/09.timing_basics">Blarg, 09 Timing basics</option>
					<option value="./roms/sprite_hit_tests/10.timing_order">Blarg, 10. Timing order</option>
					<option value="./roms/sprite_hit_tests/11.edge_timing">Blarg, 11. Edge timing</option>
				</optgroup>
				<optgroup label="MMC3 tests">
					<option value="./roms/mmc3/1-clocking">1. Clocking</option>
					<option value="./roms/mmc3/2-details">2. Details</option>
				</optgroup>
			</select>
		</form>

		<canvas id="testcanvas" width="256" height="224"></canvas>

		<pre>ARROWS = D-pad
SHIFT = select
RETURN = start
X = A
Z = B</pre>

		<script src="./nesnes.js"></script>
		<script>
			window.onload = function() {
				testselect.onchange = function() {
					testform.submit();
				};

				var params = window.location.search.replace("?", ""),
					split = params.split("="),
					param = split[0],
					game = decodeURIComponent(split[1]);

				if ( param === "game" && game ) {
					testselect.querySelector("option[value='"+game+"']").selected = true;
					
					var emu = new NesNes( testcanvas );
					emu.load( game + ".nes", true );
				}
			};
		</script>
	</body>
</html>